package rscpviewer;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Collection;
import java.util.stream.Stream;

import edu.byu.ece.rapidSmith.design.subsite.Cell;
import edu.byu.ece.rapidSmith.design.subsite.CellDesign;
import edu.byu.ece.rapidSmith.design.subsite.CellNet;
import edu.byu.ece.rapidSmith.interfaces.vivado.VivadoInterface;

public class Main {
	public static void main(String[] args) {
		CellDesign cd = null;
		String input_filename = "/home/adam/vivado_workspace/aes128_top/aes128_top.tcp";
		try {
			cd = VivadoInterface.loadTCP().getDesign(input_filename);
		} catch (IOException e) {
			e.printStackTrace();
		}
		Stream<Cell> macroCellStream = cd.getMacros();
//		long numMacroCells = macroCellStream.count();
//		if(numMacroCells > 0xFFFFFF)
//		{
//			System.out.println("There are " + numMacroCells + " in this design. That might be too many.");
//			return;
//		}
		ArrayList<Cell> macroCells = new ArrayList<Cell>();
		macroCellStream.forEach(element -> macroCells.add(element));
		Collection<CellNet> mc_internalNets = null;
		for(Cell mc : macroCells)
		{
			Collection<Cell> mc_internalCells = mc.getInternalCells();
			mc_internalNets = mc.getInternalNets();
		}
		GraphGrepSX.createFile(mc_internalNets, "/home/adam/vivado_workspace/ooc_aes128/aes_128_0_gs.tcp");
	}
}
